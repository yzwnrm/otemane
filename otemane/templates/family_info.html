{% extends "base.html" %}
{% load static %}
{% block content %}
<h2>ファミリー情報</h2>
<h3>親メンバー</h3>
<table class="table">
  <thead>
    <tr>
      <th>名前</th>
      <th>続柄</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
    {% for user in user %}
    <tr data-user-id="{{ user.id }}">
      <td>{{ user.user_name }}</td>
      <td>{{ user.get_relationship_display }}</td>
      <td>
        <a href="{% url 'app:user_update' user.id %}" class="btn btn-primary btn-sm">編集</a>
        <form method="POST" action="{% url 'app:user_delete' user.id %}" style="display:inline;">
          {% csrf_token %}
          <button
            type="button"
            class="btn btn-danger btn-sm"
            data-bs-toggle="modal"
            data-bs-target="#deleteModal"
            data-delete-url="{% url 'app:user_delete' user.id %}">
            削除
          </button>

        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<h3>子どもメンバー</h3>
<table class="table">
  <thead>
    <tr>
      <th>名前</th>
      <th>誕生日</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
    {% for child in child %}
    <tr data-child-id="{{ child.id }}">
      <td>{{ child.child_name }}</td>
      <td>{{ child.birthday }}</td>
      <td>
        <a href="{% url 'app:child_update' child.id %}" class="btn btn-primary btn-sm">編集</a>
        <form method="POST" action="{% url 'app:child_delete' child.id %}" style="display:inline;">
          {% csrf_token %}
          <button
            type="button"
            class="btn btn-danger btn-sm"
            data-bs-toggle="modal"
            data-bs-target="#deleteModal"
            data-delete-url="{% url 'app:child_delete' child.id %}">
            削除
          </button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- 削除確認モーダル -->
<div class="modal" id="deleteModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="POST" id="deleteForm">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title">削除確認</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="閉じる"></button>
        </div>
        <div class="modal-body">
          本当に削除しますか？
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">キャンセル</button>
          <button type="submit" class="btn btn-danger">削除する</button>
        </div>
      </form>
    </div>
  </div>
</div>

{% endblock %}
{% block scripts %}
    <!-- BootstrapのJavaScript（必要なもの） -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-..." crossorigin="anonymous"></script>

    <!-- 自作のJSファイル -->
    <script src="{% static 'js/info_delete.js' %}"></script>
{% endblock %}